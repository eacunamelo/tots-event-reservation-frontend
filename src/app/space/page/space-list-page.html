<main class="spaces-container">
  <div class="spaces-wrapper">

    <h2 class="section-title">Espacios disponibles</h2>

    <form
      class="filters"
      [formGroup]="filterForm"
    >
      <input
        type="text"
        placeholder="Buscar por nombre o descripción"
        formControlName="search"
      />

      <input
        type="number"
        placeholder="Capacidad mínima"
        formControlName="minCapacity"
        min="1"
      />
    </form>

    <div class="spaces-grid" *ngIf="isLoading">
      <div class="space-card skeleton-card" *ngFor="let i of [1,2,3]">
        <div class="skeleton-image"></div>
        <div class="skeleton-line title"></div>
        <div class="skeleton-line"></div>
        <div class="skeleton-line small"></div>
        <div class="skeleton-button"></div>
      </div>
    </div>

    <ng-container *ngIf="filteredSpaces$ | async as spaces">

      <div class="spaces-grid">

        <div
          class="space-card add-space-card"
          *ngIf="isAdmin()"
        >
          <button
            type="button"
            class="add-space-btn"
            (click)="goToCreateSpace()"
          >
            <i class="pi pi-plus"></i>
          </button>

          <h3>Crear espacio</h3>
          <p class="description">
            Agrega un nuevo espacio para reservas
          </p>
        </div>

        <div
          class="empty-state"
          *ngIf="!isLoading && spaces.length === 0"
        >
          No hay espacios disponibles
        </div>

        <div
          class="space-card"
          *ngFor="let space of spaces; trackBy: trackById"
        >

          <div class="image-wrapper">
            <img
              [src]="space.image_url"
              alt="Imagen del espacio"
              class="space-image"
            />
          </div>

          <h3>{{ space.name }}</h3>
          <p class="description">{{ space.description }}</p>

          <div class="capacity">
            <i class="pi pi-users"></i>
            <span>{{ space.capacity }} personas</span>
          </div>

          <button
            pButton
            type="button"
            label="Reservar"
            icon="pi pi-calendar"
            class="reserve-btn"
            (click)="goToReservationForm(space.id)"
            *ngIf="!isAdmin()"
          ></button>

          <button
            pButton
            type="button"
            label="Editar"
            icon="pi pi-pencil"
            class="p-button-secondary reserve-btn"
            (click)="goToEditSpace(space.id)"
            *ngIf="isAdmin()"
          ></button>

        </div>

      </div>

    </ng-container>

  </div>
</main>
